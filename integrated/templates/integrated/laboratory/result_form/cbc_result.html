<DOCTYPE html>
    {% load static %}
    <head>
        <title>HEMATOLOGY</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <style>
    body {
        margin: 0;
        padding: 0;
        /* background-color: #FAFAFA; */
        font: 12pt "Times New Roman";
    }
    * {
        box-sizing: border-box;
        -moz-box-sizing: border-box;
    }
    .page {
        width: 21cm;
        min-height: 29.7cm;
        /* padding: 2cm; */
        margin: 1cm auto;
        border: 1px #D3D3D3 solid;
        border-radius: 5px;
        background: white;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }
    .subpage {
        padding: 1cm;
        /* padding: 10px; */
        /* border: 5px red solid; */
        height: 256mm;
        background-image:url("{% static 'integrated/img/lab-bg.png'%}") ;
        /* outline: 1cm #FFEAEA solid; */
        background-repeat: no-repeat; background-size: cover; background-position: center center;
    }
    
    @page {
        size: A4;
        margin: 0;
    }
    @media print {
        .page {
            margin: 0;
            border: initial;
            border-radius: initial;
            width: initial;
            min-height: initial;
            box-shadow: initial;
            background: initial;
            page-break-after: always;
        }
    }
    .ptx_data td {
  border: .5px solid rgb(196, 192, 192);
  border-collapse: collapse;
  padding: 4px;
}
.result_data td {
  border: .5px solid rgb(196, 192, 192);
  border-collapse: collapse;
  padding: 5px;
  
}
.staff_data td {
  border: .5px solid rgb(196, 192, 192);
  border-collapse: collapse;
}

        </style>
    </head>
    <body>
        {% for r in result %}
        <div class="book">
            <div class="page">
                <div class="subpage">
                 <div class="header" style="height: 100px;">
                    <table style="border-bottom: 4px solid rgb(14, 14, 187);width: 100%;">
                        <tr>
                        <td><img src="{% static 'integrated/img/brghgmclogo.png'%}" style="width: 70px; height: 70px;margin: 0px;" /></td>
                        <td><img src="{% static 'integrated/img/doh.png'%}" style="width: 70px; height: 70px;margin: 0px;" /></td>
                        <td style="text-align: center;padding: 0px;">
                          <span style="font-weight: bolder;font-size: 14px;color:rgb(3, 87, 45)">BICOL REGION GENERAL HOSPITAL AND GERIATRIC MEDICAL CENTER</span><br>
                          <span class="fw-bolder" style="font-size: 12px;">Formerly( Bicol Sanitarium )</span><br>
                          <span style="font-size: 10px;">San Pedro, Cabusao, Camarines Sur</span><br>
                          <span style="font-size: 10px;">Telephone Nos.: (054) 473-2244; 472-4422, 881-1033, 881-1761</span><br>
                          <span style="font-size: 10px;">Email Address: bicolsan@yahoo.com; brghgmc@gmail.com</span>
                        </td>
                        </tr>
                    </table>
                   
                 </div>
                 
                 <div class="content" style="height: 950px;padding: 0px;margin: 0px;">
                    <h5 class="text-center fw-bolder mb-4" >HEMATOLOGY</h5>
                    <table class="w-100 ptx_data mb-2" >
                     
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">PATIENT:</td>
                            <td class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder">{{patient.patlast}}, {{patient.patfirst}}</span></td>
                            <td class="fw-bolder col-2" align="right" style="font-size: 12px;">RESULT DATE:</td>
                            <td class="col-4" style="font-size: 14px;"><span class="fw-bolder">{{ r.date_verified}}</span></td>
                        </tr>
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">HOSP NO.:</td>
                            <td class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder">{{patient.hpercode}}</span></td>
                            <td class="fw-bolder col-2" align="right" style="font-size: 12px;">CONTROL NO.:</td>
                            <td class="col-4" style="font-size: 16px;"><span class="fw-bolder text-danger">{{ctr}}</span></td>
                        </tr>
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">GENDER:</td>
                            <td class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder">{{ patient.patsex}}</span></td>
                            <td class="fw-bolder col-2" align="right" style="font-size: 12px;">WARD:</td>
                            <td class="col-4" style="font-size: 14px;"><span class="fw-bolder">{{ward}}</span></td>
                        </tr>
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">AGE:</td>
                            <td class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder">{{patient.patage}}</span></td>
                            <td class="fw-bolder col-2" align="right" style="font-size: 12px;">PHYSICIAN:</td>
                            <td class="col-4" style="font-size: 14px;"><span class="fw-bolder">{{doctor}}</span></td>
                        </tr>
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">DOB:</td>
                            <td colspan="3" class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder">{{patient.birthdate}}</span></td>
                        </tr>
                     
                        <tr>
                            <td class="fw-bolder col-1" align="right" style="font-size: 12px;">Notes:</td>
                            <td colspan="3" class="col-4" align="left" style="font-size: 14px;"><span class="fw-bolder text-danger">{{ r.note}}</span></td>
                        </tr>
                       
                    </table>

                    <table class="w-100 result_data mb-2 table table-striped">
                        <tr class="bg-dark text-white">
                            <td class="col-2 fw-bolder" align="right" ></td>
                            <td class="col-2 fw-bolder" align="center">RESULT</td>
                            <td class="col-2 fw-bolder" align="center" >UNIT</td>
                            <td class="col-2 fw-bolder" align="center" >RANGE</td>
                            
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >Hemoglobin</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.hemoglobin}}</span></td>
                            <td class="col-2 fw-bolder" align="center">g/dL</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if patient.patage < 1 %}
                                    4.00 - 6.00
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                    4.10 - 5.50
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                     4.00 - 5.40
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                        4.00 - 5.40
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                    11.5 - 15.2
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                    13.0 - 17.0
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >Hematocrit</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.hematocrit}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                    44.0 - 64.0
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                36.0 - 44.0
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                    36.0 - 44.0
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                37.0 - 45.0
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                35.0 - 46.0
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                39.0 - 52.0
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >RBC Count</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.rbc_count}}</span></td>
                            <td class="col-2 fw-bolder" align="center">10<sup>6</sup>/μL</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                4.00 - 6.00
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                4.10 - 5.50
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                4.10 - 5.50
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                4.00 - 5.40
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                3.80 - 5.20
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                4.20 - 6.00
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >MCV</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.mcv}}</span></td>
                            <td class="col-2 fw-bolder" align="center">μm<sup>3</sup></td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                100.0 - 112.0
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                73.0 - 89.0
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                73.0 - 89.0
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                77.0 - 91.0
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                77.0 - 97.0
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                76.0 - 100.0
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >MCH</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.mch}}</span></td>
                            <td class="col-2 fw-bolder" align="center">pg</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                30.0 - 38.0
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                30.0 - 38.0
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                24.0 - 30.0
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                24.0 - 30.0
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                26.0 - 34.0
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                26.0 - 34.0
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >MCHC</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.mchc}}</span></td>
                            <td class="col-2 fw-bolder" align="center">g/dL</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                32.0 - 36.0
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                32.0 - 36.0
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                32.0 - 36.0
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                32.0 - 36.0
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                32.0 - 35.0
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                32.0 - 35.0
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >WBC Count</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.wbc_count}}</span></td>
                            <td class="col-2 fw-bolder" align="center">10<sup>3</sup>/μL</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                10.00 - 26.00
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                5.00 - 15.00
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                5.00 - 15.00
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                4.50 - 13.50
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                3.50 - 10.00
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                3.50 - 10.00
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr class="bg-secondary text-white">
                            <td class="col-2 fw-bolder " align="center" >Differential Count:</td>
                            <td class="col-2 fw-bolder" align="center"><span class=""></span></td>
                            <td class="col-2 fw-bolder" align="center"></td>
                            <td class="col-2 fw-bolder" align="center" ></td>
                        </tr>
                    
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >- Neutrophil</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.neutrophil}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                6.00 - 26.00
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                1.50 - 8.50
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                1.50 - 8.50
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                1.80 - 8.00
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                1.60 - 7.00
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                1.60 - 7.00
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >- Lymphocytes</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.lymphocytes}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                2.00 - 11.00
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                2.00 - 8.00
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                2.00 - 8.00
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                1.50 - 6.50
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                1.00 - 3.00
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                1.00 - 3.00
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >- Monocytes</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.monocytes}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                0.40 - 3.10
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                0.00 - 0.80
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                0.00 - 0.80
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                0.00 - 0.80
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                0.20 - 0.80
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                0.20 - 0.80
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >- Eosinophil</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.eosinophil}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                0.00 - 0.85
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                0.00 - 0.65
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                0.00 - 0.65
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                0.00 - 0.60
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                0.00 - 0.50
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                0.00 - 0.50
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >-Basophils</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.basophils}}</span></td>
                            <td class="col-2 fw-bolder" align="center">%</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                0.00 - 0.65
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                0.00 - 0.20
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                0.00 - 0.20
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                0.00 - 0.20
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                                0.00 - 0.15
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                0.00 - 0.15
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder" align="center" >Platelet Count</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.platelet_count}}</span></td>
                            <td class="col-2 fw-bolder" align="center">10<sup>3</sup>/μL</td>
                            <td class="col-2 fw-bolder" align="center" >
                                {% if ppatient.patage < 1 %}
                                200 - 400
                                {% elif patient.patage >= 1 and patient.patage <= 2 %}
                                200 - 400
                                {% elif patient.patage >= 3 and patient.patage <= 5 %}
                                200 - 400
                                {% elif patient.patage >= 6 and patient.patage <= 10 %}
                                200 - 400
                                {% elif patient.patage > 10 and patient.patsex == 'F' %}
                               150 - 400
                                {% elif patient.patage > 10 and patient.patsex == 'M' %}
                                150 - 400
                                {% else %}
                                   ------
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="col-2 fw-bolder bg-dark text-white" align="center" >Blood Group</td>
                            <td colspan="3" class="col-2 fw-bolder" align="center"><span class="">{{ r.blood_group}}</span></td>
                        </tr>

                        <tr>
                            <td class="col-2 fw-bolder" align="center" >Reticulocytes</td>
                            <td class="col-2 fw-bolder" align="center"><span class="">{{ r.reticulocytes_count}}</span></td>
                            <td class="col-2 fw-bolder" align="center">10<sup>6</sup>/μL</td>
                            <td class="col-2 fw-bolder" align="center" >4.20 - 6.00</td>
                        </tr>
                        

                        
                    </table>

                    

                    <table class="w-100 staff_data" style="margin-top: 30px;">
                        <tr class="bg-secondary text-white fw-bolder">
                            <td>Perfomed By:</td>
                            <td>Verified By:</td>
                            <td>Approved By:</td>
                        </tr>
                        <tr class="text-center" style="height: 100px;">
                            <td >
                                <p style="margin-bottom: 50px;"></p>
                                <p class="fw-bolder mb-0">{{r.perform_by_name}}</p>
                                <p>Lic. No. -------</p>
                            </td>
                            <td style="padding: 0px;">
                                <p style="margin-bottom: 50px;"></p>
                                <p class="fw-bolder mb-0">{{r.verify_by_name}}</p>
                                <p>Lic. No.-------</p>
                            </td>
                            <td>
                                <p style="margin-bottom: 50px;"></p>
                                <p class="fw-bolder mb-0">RAYMUNDO B. IBARRIENTOS, MD.</p>
                                <p>Lic. No. 0078995</p>
                            </td>
                        </tr>
                        <tr class="text-center fw-bolder">
                            <td>Medical Technologist</td>
                            <td>Medical Technologist</td>
                            <td>Pathologist</td>
                        </tr>
                    </table>

                </div>
                <div class="footer" style="height: 20px;">
                    <table style="font-size: 12px;width: 100%;border-top: 4px solid rgb(14, 14, 187);font-style: italic;">
                        <tr>
                            <td width="30%"><span>BRGHGMC-F-MS-LAB-001</span></td>
                            <td width="20%" align="center"><span>Rev 8</span></td>
                            <td width="25%"><span>Effectivity Date: May 2, 2023</span></td>
                            <td width="25%" align="right"><img src="{% static 'integrated/img/padabrghgmc.png'%}" style="width: 150px; height: 20px;margin: 0px;" /></td>
                        </tr>
                    </table>

                </div>
               
            </div>
           
        </div>
        
        {% endfor %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
        <script>

            // ///////////////
            const rbc = [100,200,300,400,500,600,700,800,900,1000];

            new Chart("lineChart", {
            type: "line",
            data: {
                labels: rbc,
                datasets: [{ 
                data: [860,1140,1060,1060,1070,1110,1330,2210,7830,2478],
                borderColor: "red",
                fill: false
                }, { 
                data: [1600,1700,1700,1900,2000,2700,4000,5000,6000,7000],
                borderColor: "green",
                fill: false
                }, { 
                data: [300,700,2000,5000,6000,4000,2000,1000,200,100],
                borderColor: "blue",
                fill: false
                }]
            },
            options: {
                legend: {display: false}
            }
            });


            // //////////////////////
            const xValues = [];
            const yValues = [];
            generateData("Math.sin(x)", 0, 10, 0.5);

            new Chart("myChart", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                fill: false,
                pointRadius: 4,
                borderColor: "gray",
                data: yValues
                }]
            },    
            options: {
                legend: {display: false},
                title: {
                display: true,
                text: "y = sin(x)",
                fontSize: 16
                }
            }
            });
            function generateData(value, i1, i2, step = 1) {
            for (let x = i1; x <= i2; x += step) {
                yValues.push(eval(value));
                xValues.push(x);
            }
            }
            // /////////////////////////
    
      </script>

    </body>
</html>